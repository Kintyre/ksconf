#!/usr/bin/env python
import os
from setuptools import setup

def get_ver():
    # Todo: Add fall-back method for tarballs (sdist) builds.  See what others have done.
    from ksconf.vc.git import git_cmd
    ver_file = os.path.join("ksconf", "_version.py")
    gitout = git_cmd(["describe", "--tags", "--always", "--dirty"])
    version = gitout.stdout.strip()
    version = version.lstrip("v")   # Tags format is v0.0.0
    open(ver_file, "w").write("# Version file autogenerated by the build process.\n"
                              "version = {0!r}\n".format(version))
    return version


setup(name="KintyreSplunkConfTool",
      version=get_ver(),
      description="Kintyre's Splunk Configuration Tool",
      author="Lowell Alleman",
      author_email="lowell@kintyre.co",
      url="https://github.com/Kintyre/ksconf",
      packages=[
          "ksconf",
          "ksconf.commands",
          "ksconf.conf",
          "ksconf.util",
          "ksconf.vc",
      ],
      # Not required, but useful.
      # install_requires=[ "argcomplete "],
      entry_points={
          "console_scripts": [
              "ksconf = ksconf.cli:cli",
          ]
      },
)
